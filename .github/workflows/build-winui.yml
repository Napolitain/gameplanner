name: Build WinUI3 Application

on:
  push:
    branches: [ main, develop, 'copilot/**' ]
  pull_request:
    branches: [ main, develop ]

jobs:
  build-winui:
    name: Build WinUI3 App on Windows
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup MSBuild
      uses: microsoft/setup-msbuild@v2
    
    - name: Setup NuGet
      uses: NuGet/setup-nuget@v2
    
    - name: Note about WinUI3
      run: |
        echo "WinUI3 application requires a complete Visual Studio project setup."
        echo "The current code provides a template structure for the UI."
        echo "A full WinUI3 .vcxproj/.sln is needed for complete compilation."
        echo "This job validates the CMake configuration and library build on Windows."
    
    - name: Setup Visual Studio environment
      uses: ilammy/msvc-dev-cmd@v1
    
    - name: Configure CMake (Library only)
      run: |
        mkdir build
        cd build
        cmake .. -G "Visual Studio 17 2022" -A x64
    
    - name: Build Core Library
      run: |
        cd build
        cmake --build . --config Release --target GamePlannerLib
    
    - name: Build Demo (if available)
      run: |
        cd build
        cmake --build . --config Release --target GamePlannerDemo
      continue-on-error: true
    
    - name: Upload artifacts
      uses: actions/upload-artifact@v4
      with:
        name: gameplanner-windows-msvc
        path: |
          build/lib/Release/GamePlannerLib.lib
          build/examples/Release/GamePlannerDemo.exe
      continue-on-error: true
    
    - name: WinUI3 Build Status
      run: |
        echo "âœ“ Core library built successfully"
        echo "Note: Full WinUI3 application requires:"
        echo "  - Complete Visual Studio 2022 project files"
        echo "  - Windows App SDK installed"
        echo "  - WinRT wrapper classes for data binding"
        echo "See winui/README.md for more details"
